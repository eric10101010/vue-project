{"version":3,"sources":["webpack:///./src/views/backend/Coupons.vue","webpack:///./src/components/backendModal/CouponModal.vue","webpack:///./src/components/backendModal/CouponModal.vue?c883","webpack:///./src/views/backend/Coupons.vue?9472"],"names":["class","width","role","aria-hidden","active","isLoading","status","type","value","openCouponModal","coupon","pages","totalPages","currentPage","getCoupons","getFilterData","filterData","item","key","id","is_enabled","title","code","percent","Date","due_date","toLocaleString","checked","putCoupon","for","itemID","openDeleteModal","ref","coupon-data","tempCoupon","tab","deleteCoupon","data-bs-backdrop","data-bs-keyboard","tabindex","data-bs-dismiss","aria-label","resetForm","action","selectSubmit","errors","name","rules","placeholder","disabled","Object","keys","length","undefined","data","modal","emits","props","methods","addCoupon","apiUrl","date","couponObj","this","setDate","getDate","getTime","axios","post","then","res","success","hideModal","$emit","swal","message","catch","put","showModal","show","hide","$refs","couponForm","mounted","couponModal","watch","couponData","render","coupons","searchData","page","get","pagination","total_pages","current_page","loading","delete","deleteModal","created","components","CouponModal","DelModal","computed","filter","match"],"mappings":"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","file":"js/chunk-2d0e9004.ba31cef3.js","sourcesContent":["<template>\n  <div>\n    <Loading :active=\"isLoading.status\"></Loading>\n    <div class=\"sticky-top bg-white ps-2 py-3 mb-1\">\n      <h2 class=\"h3\">優惠券列表</h2>\n      <div class=\"d-flex\">\n        <input\n          type=\"button\"\n          value=\"新增\"\n          class=\"btn btn-primary me-2\"\n          @click=\"openCouponModal(this.coupon)\"\n        />\n        <Page\n          :pages=\"totalPages\"\n          :currentPage=\"currentPage\"\n          @display-page=\"getCoupons\"\n          class=\"me-2\"\n        ></Page>\n        <div class=\"input-group\">\n          <span class=\"input-group-text\">搜尋優惠券名稱</span>\n          <Search @filter-data=\"getFilterData\"></Search>\n        </div>\n      </div>\n    </div>\n    <table class=\"table\">\n      <thead>\n        <tr>\n          <th class=\"text-center border-secondary\">優惠券名稱</th>\n          <th class=\"border-secondary\">優惠券代碼</th>\n          <th class=\"text-center border-secondary\">折扣率</th>\n          <th class=\"border-secondary\">期限</th>\n          <th class=\"border-secondary\">是否啟用</th>\n          <th class=\"border-secondary\">操作</th>\n        </tr>\n      </thead>\n      <tbody>\n        <tr v-for=\"item in filterData\" :key=\"item.id\" :class=\"{ 'table-primary': item.is_enabled }\">\n          <td class=\"text-center\">{{ item.title }}</td>\n          <td>{{ item.code }}</td>\n          <td class=\"text-center\">{{ item.percent }}</td>\n          <td>{{ new Date(item.due_date).toLocaleString() }}</td>\n          <td width=\"200\">\n            <div class=\"form-check form-switch\">\n              <input\n                class=\"form-check-input\"\n                type=\"checkbox\"\n                :id=\"item.id\"\n                :checked=\"item.is_enabled\"\n                @change=\"putCoupon(item)\"\n              />\n              <label class=\"form-check-label\" :for=\"item.id\">\n                {{ item.is_enabled ? '已啟用' : '未啟用' }}\n                <span\n                  class=\"spinner-border spinner-border-sm me-2\"\n                  role=\"status\"\n                  aria-hidden=\"true\"\n                  v-if=\"isLoading.itemID === item.id\"\n                ></span>\n              </label>\n            </div>\n          </td>\n          <td>\n            <div class=\"btn-group\">\n              <button\n                type=\"button\"\n                class=\"btn btn-outline-dark border-secondary\"\n                :class=\"{ disabled: item.is_enabled }\"\n                @click=\"openCouponModal(item)\"\n              >\n                修改\n              </button>\n              <input\n                type=\"button\"\n                value=\"刪除\"\n                class=\"btn btn-outline-danger border-secondary\"\n                :class=\"{ disabled: item.is_enabled }\"\n                @click=\"openDeleteModal(item)\"\n              />\n            </div>\n          </td>\n        </tr>\n      </tbody>\n    </table>\n    <CouponModal ref=\"couponModal\" :coupon-data=\"tempCoupon\" @update=\"getCoupons\"></CouponModal>\n    <DelModal ref=\"deleteModal\" :title=\"tempCoupon.code\" tab=\"優惠券\" @delete-data=\"deleteCoupon\">\n    </DelModal>\n  </div>\n</template>\n\n<script>\nimport CouponModal from '@/components/backendModal/CouponModal.vue';\nimport DelModal from '@/components/backendModal/DeleteModal.vue';\n\nexport default {\n  data() {\n    return {\n      coupons: [],\n      coupon: {\n        title: '',\n        percent: 0,\n        code: '',\n      },\n      tempCoupon: {},\n      currentPage: 1,\n      totalPages: 0,\n      searchData: '',\n    };\n  },\n  methods: {\n    getCoupons(page = 1) {\n      const apiUrl = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupons?page=${page}`;\n      this.isLoading.status = true;\n      this.axios\n        .get(apiUrl)\n        .then((res) => {\n          if (res.data.success) {\n            this.coupons = res.data.coupons;\n            this.totalPages = res.data.pagination.total_pages;\n            this.currentPage = res.data.pagination.current_page;\n            this.isLoading.status = false;\n          } else {\n            this.swal(res.data.message, 'error');\n          }\n        })\n        .catch(() => {\n          this.swal('無法取得優惠券資料喔～快去看什麼問題吧！', 'error');\n        });\n    },\n    // 更新是否啟用\n    putCoupon(item) {\n      const apiUrl = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${item.id}`;\n      const couponObj = { data: { ...item } };\n      this.isLoading.itemID = item.id;\n      if (couponObj.data.is_enabled === 0) {\n        couponObj.data.is_enabled = 1;\n      } else {\n        couponObj.data.is_enabled = 0;\n      }\n      this.axios\n        .put(apiUrl, couponObj)\n        .then((res) => {\n          if (res.data.success) {\n            this.loading = false;\n            this.getCoupons();\n            this.swal(res.data.message);\n            this.isLoading.itemID = '';\n          } else {\n            this.swal(res.data.message, 'error');\n          }\n        })\n        .catch(() => {\n          this.swal('無法修改資料喔～快去看什麼問題吧！', 'error');\n        });\n    },\n    deleteCoupon() {\n      const apiUrl = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\n      this.isLoading.itemID = this.tempCoupon.id;\n      this.axios\n        .delete(apiUrl)\n        .then((res) => {\n          if (res.data.success) {\n            this.$refs.deleteModal.hideModal();\n            this.getCoupons();\n            this.swal(res.data.message);\n            this.isLoading.itemID = '';\n          } else {\n            this.swal(res.data.message, 'error');\n          }\n        })\n        .catch(() => {\n          this.swal('無法刪除資料喔～快去看什麼問題吧！', 'error');\n        });\n    },\n    openCouponModal(item) {\n      this.tempCoupon = { ...item };\n      this.$refs.couponModal.showModal();\n    },\n    openDeleteModal(item) {\n      this.tempCoupon = { ...item };\n      this.$refs.deleteModal.showModal();\n    },\n    getFilterData(data) {\n      this.searchData = data;\n    },\n  },\n  created() {\n    this.getCoupons();\n  },\n  components: {\n    CouponModal,\n    DelModal,\n  },\n  computed: {\n    filterData() {\n      return this.coupons.filter((item) => item.code.match(this.searchData));\n    },\n  },\n};\n</script>\n","<template>\n  <div\n    class=\"modal fade\"\n    ref=\"couponModal\"\n    data-bs-backdrop=\"static\"\n    data-bs-keyboard=\"false\"\n    tabindex=\"-1\"\n  >\n    <div class=\"modal-dialog\">\n      <div class=\"modal-content\">\n        <div class=\"modal-header\">\n          <p class=\"modal-title h5 text-primary\" v-if=\"!tempCoupon.id\">新增優惠券</p>\n          <p class=\"modal-title h5\" v-else>修改優惠券</p>\n          <button\n            type=\"button\"\n            class=\"btn-close\"\n            data-bs-dismiss=\"modal\"\n            aria-label=\"Close\"\n            @click=\"resetForm\"\n          ></button>\n        </div>\n        <Form action=\"\" v-slot=\"{ errors }\" ref=\"couponForm\" @submit=\"selectSubmit\">\n          <div class=\"modal-body\">\n            <div class=\"row g-3\">\n              <div class=\"col-12\">\n                <label for=\"couponName\" class=\"form-label\"\n                  >名稱\n                  <span class=\"text-danger\">*</span>\n                </label>\n                <Field\n                  id=\"couponName\"\n                  name=\"名稱\"\n                  type=\"text\"\n                  class=\"form-control\"\n                  :class=\"{ 'is-invalid': errors['名稱'] }\"\n                  rules=\"required\"\n                  v-model=\"tempCoupon.title\"\n                >\n                </Field>\n                <error-message name=\"名稱\" class=\"invalid-feedback\"></error-message>\n              </div>\n              <div class=\"col\">\n                <label for=\"couponPercent\" class=\"form-label\"\n                  >折扣率\n                  <span class=\"text-danger\">*</span>\n                </label>\n                <Field\n                  id=\"couponPercent\"\n                  name=\"折扣率\"\n                  type=\"number\"\n                  class=\"form-control\"\n                  placeholder=\"80 為 8 折\"\n                  :class=\"{ 'is-invalid': errors['折扣率'] }\"\n                  rules=\"min_value:0|max_value:99|required\"\n                  v-model.number=\"tempCoupon.percent\"\n                >\n                </Field>\n                <error-message name=\"折扣率\" class=\"invalid-feedback\"></error-message>\n              </div>\n              <div class=\"col\">\n                <label for=\"couponCode\" class=\"form-label\"\n                  >代碼\n                  <span class=\"text-danger\">*</span>\n                </label>\n                <Field\n                  id=\"couponCode\"\n                  name=\"代碼\"\n                  type=\"text\"\n                  class=\"form-control\"\n                  placeholder=\"英數較佳 e.g. VS777\"\n                  :class=\"{ 'is-invalid': errors['代碼'] }\"\n                  rules=\"min:5|required\"\n                  v-model=\"tempCoupon.code\"\n                >\n                </Field>\n                <error-message name=\"代碼\" class=\"invalid-feedback\"></error-message>\n              </div>\n            </div>\n          </div>\n          <div class=\"modal-footer\">\n            <button\n              type=\"button\"\n              class=\"btn btn-secondary\"\n              data-bs-dismiss=\"modal\"\n              @click=\"resetForm\"\n            >\n              Close\n            </button>\n            <button\n              type=\"submit\"\n              class=\"btn btn-primary\"\n              :disabled=\"Object.keys(errors).length !== 0\"\n            >\n              <template v-if=\"tempCoupon.id === undefined\">\n                <span\n                  class=\"spinner-border spinner-border-sm me-2\"\n                  role=\"status\"\n                  aria-hidden=\"true\"\n                  v-if=\"isLoading.itemID === 'add'\"\n                ></span\n                >新增\n              </template>\n              <template v-else>\n                <span\n                  class=\"spinner-border spinner-border-sm me-2\"\n                  role=\"status\"\n                  aria-hidden=\"true\"\n                  v-if=\"isLoading.itemID\"\n                ></span\n                >修改\n              </template>\n            </button>\n          </div>\n        </Form>\n      </div>\n    </div>\n  </div>\n</template>\n\n<script>\nimport Modal from 'bootstrap/js/dist/modal';\n\nexport default {\n  data() {\n    return {\n      modal: {},\n      tempCoupon: {\n        title: '',\n        percent: 0,\n        code: '',\n      },\n    };\n  },\n  emits: ['update'],\n  props: ['couponData'],\n  methods: {\n    addCoupon() {\n      const apiUrl = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon`;\n      const date = new Date();\n      const couponObj = { data: { ...this.tempCoupon } };\n      // setDate 會變更現在日期，例如當月 23 號，setDate(30)，會變成當月 30 號\n      // 暫時設定往後 30 天，之後改成可選日期\n      date.setDate(date.getDate() + 30);\n      couponObj.data.due_date = date.getTime();\n      couponObj.data.is_enabled = 0;\n      this.isLoading.itemID = 'add';\n      this.axios\n        .post(apiUrl, couponObj)\n        .then((res) => {\n          if (res.data.success) {\n            this.hideModal();\n            this.$emit('update');\n            this.swal(res.data.message);\n            this.isLoading.itemID = '';\n          } else {\n            this.swal(res.data.message, 'error');\n          }\n        })\n        .catch(() => {\n          this.swal('無法加入資料喔～快去看什麼問題吧！', 'error');\n        });\n    },\n    putCoupon() {\n      const couponObj = { data: { ...this.tempCoupon } };\n      const apiUrl = `${process.env.VUE_APP_API}/api/${process.env.VUE_APP_PATH}/admin/coupon/${this.tempCoupon.id}`;\n      this.isLoading.itemID = this.tempCoupon.id;\n      this.axios\n        .put(apiUrl, couponObj)\n        .then((res) => {\n          if (res.data.success) {\n            this.hideModal();\n            this.$emit('update');\n            this.swal(res.data.message);\n            this.isLoading.itemID = '';\n          } else {\n            this.swal(res.data.message, 'error');\n          }\n        })\n        .catch(() => {\n          this.swal('無法修改資料喔～快去看什麼問題吧！', 'error');\n        });\n    },\n    selectSubmit() {\n      if (!this.tempCoupon.id) {\n        this.addCoupon();\n      } else {\n        this.putCoupon();\n      }\n    },\n    showModal() {\n      this.modal.show();\n    },\n    hideModal() {\n      this.modal.hide();\n    },\n    resetForm() {\n      this.$refs.couponForm.resetForm();\n    },\n  },\n  mounted() {\n    this.modal = new Modal(this.$refs.couponModal);\n  },\n  watch: {\n    couponData(item) {\n      this.tempCoupon = item;\n    },\n  },\n};\n</script>\n","import { render } from \"./CouponModal.vue?vue&type=template&id=35605436\"\nimport script from \"./CouponModal.vue?vue&type=script&lang=js\"\nexport * from \"./CouponModal.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script","import { render } from \"./Coupons.vue?vue&type=template&id=f73e5176\"\nimport script from \"./Coupons.vue?vue&type=script&lang=js\"\nexport * from \"./Coupons.vue?vue&type=script&lang=js\"\nscript.render = render\n\nexport default script"],"sourceRoot":""}