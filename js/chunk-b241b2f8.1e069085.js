(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-b241b2f8"],{b0c0:function(e,t,a){var r=a("83ab"),c=a("9bf2").f,o=Function.prototype,d=o.toString,n=/^\s*function ([^ (]*)/,l="name";r&&!(l in o)&&c(o,l,{configurable:!0,get:function(){try{return d.call(this).match(n)[1]}catch(e){return""}}})},efd9:function(e,t,a){"use strict";a.r(t);a("b0c0");var r=a("7a23"),c={class:"sticky-top bg-white ps-2 py-3 mb-1"},o=Object(r["createVNode"])("h2",{class:"h3"},"訂單列表",-1),d={class:"d-flex"},n={class:"table"},l=Object(r["createVNode"])("thead",null,[Object(r["createVNode"])("tr",null,[Object(r["createVNode"])("th",{width:"100",class:"text-center border-secondary"},"訂購人"),Object(r["createVNode"])("th",{class:"border-secondary"},"聯絡信箱"),Object(r["createVNode"])("th",{class:"border-secondary"},"連絡電話"),Object(r["createVNode"])("th",{class:"border-secondary"},"住址"),Object(r["createVNode"])("th",{class:"border-secondary"},"商品"),Object(r["createVNode"])("th",{class:"text-end border-secondary"},"總金額"),Object(r["createVNode"])("th",{width:"200",class:"border-secondary"},"付款狀態"),Object(r["createVNode"])("th",{class:"border-secondary"},"操作")])],-1),s={class:"text-center"},i={class:"text-end"},b={class:"form-check form-switch"},u={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},O={class:"btn-group"};function j(e,t,a,j,p,h){var m=Object(r["resolveComponent"])("Loading"),V=Object(r["resolveComponent"])("Page"),N=Object(r["resolveComponent"])("Search"),g=Object(r["resolveComponent"])("OrderModal"),f=Object(r["resolveComponent"])("DelModal");return Object(r["openBlock"])(),Object(r["createBlock"])("div",null,[Object(r["createVNode"])(m,{active:e.isLoading.status},null,8,["active"]),Object(r["createVNode"])("div",c,[o,Object(r["createVNode"])("div",d,[Object(r["createVNode"])(V,{pages:p.totalPages,currentPage:p.currentPage,onDisplayPage:h.getOrders,class:"me-2"},null,8,["pages","currentPage","onDisplayPage"]),Object(r["createVNode"])(N,{onFilterData:h.getFilterData},null,8,["onFilterData"])])]),Object(r["createVNode"])("table",n,[l,Object(r["createVNode"])("tbody",null,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(h.filterData,(function(t){return Object(r["openBlock"])(),Object(r["createBlock"])("tr",{key:t.id,class:{"table-primary":t.is_paid}},[Object(r["createVNode"])("td",s,Object(r["toDisplayString"])(t.user.name),1),Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(t.user.email),1),Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(t.user.tel),1),Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(t.user.address),1),Object(r["createVNode"])("td",null,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(t.products,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("p",{key:e.product.id,class:"mb-0"},Object(r["toDisplayString"])(e.product.title),1)})),128))]),Object(r["createVNode"])("td",i,Object(r["toDisplayString"])(t.total),1),Object(r["createVNode"])("td",null,[Object(r["createVNode"])("div",b,[Object(r["createVNode"])("input",{class:"form-check-input",type:"checkbox",id:t.id,checked:t.is_paid,onChange:function(e){return h.putOrder(t,"isPaid")}},null,40,["id","checked","onChange"]),Object(r["createVNode"])("label",{class:"form-check-label",for:t.id},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(t.is_paid?"已付款":"未付款")+" ",1),e.isLoading.itemID===t.id?(Object(r["openBlock"])(),Object(r["createBlock"])("span",u)):Object(r["createCommentVNode"])("",!0)],8,["for"])])]),Object(r["createVNode"])("td",null,[Object(r["createVNode"])("div",O,[Object(r["createVNode"])("input",{type:"button",value:"修改",class:["btn btn-outline-dark border-secondary",{disabled:t.is_paid}],onClick:function(e){return h.openEditModal(t)}},null,10,["onClick"]),Object(r["createVNode"])("input",{type:"button",value:"刪除",class:["btn btn-outline-danger border-secondary",{disabled:!t.is_paid}],onClick:function(e){return h.openDeleteModal(t)}},null,10,["onClick"])])])],2)})),128))])]),Object(r["createVNode"])(g,{ref:"orderModal",data:p.tempOrder,onEditTotal:h.putOrder},null,8,["data","onEditTotal"]),Object(r["createVNode"])(f,{ref:"deleteModal",title:p.tempOrder.user.name,tab:"訂單",onDeleteData:h.deleteOrder},null,8,["title","onDeleteData"])])}var p=a("5530"),h=(a("99af"),a("4de4"),a("ac1f"),a("466d"),{class:"modal fade",ref:"orderModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1"}),m={class:"modal-dialog"},V={class:"modal-content"},N=Object(r["createVNode"])("div",{class:"modal-header"},[Object(r["createVNode"])("p",{class:"modal-title h5"},"修改訂單"),Object(r["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close"})],-1),g={class:"modal-body"},f={class:"table table-bordered border-secondary"},y=Object(r["createVNode"])("th",null,"訂購時間",-1),D=Object(r["createVNode"])("th",null,"訂購 ID",-1),v=Object(r["createVNode"])("th",null,"訂購人",-1),k=Object(r["createVNode"])("th",null,"聯絡信箱",-1),w=Object(r["createVNode"])("th",null,"聯絡電話",-1),S=Object(r["createVNode"])("th",null,"地址",-1),M=Object(r["createVNode"])("th",null,"商品清單",-1),x={class:"ms-auto"},C={class:"text-end mb-0 border-top pt-1"},B=Object(r["createVNode"])("th",null,"折價券",-1),P=Object(r["createVNode"])("th",null,"備註",-1),_=Object(r["createVNode"])("th",null,"付款狀態",-1),L={class:"col"},T=Object(r["createVNode"])("label",{for:"editTotal",class:"form-label"},[Object(r["createTextVNode"])("修改金額 "),Object(r["createVNode"])("span",{class:"text-danger"},"*")],-1),F={class:"modal-footer"},$=Object(r["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal"},"Close",-1);function I(e,t,a,c,o,d){var n=Object(r["resolveComponent"])("Field"),l=Object(r["resolveComponent"])("error-message"),s=Object(r["resolveComponent"])("Form");return Object(r["openBlock"])(),Object(r["createBlock"])("div",h,[Object(r["createVNode"])("div",m,[Object(r["createVNode"])("div",V,[N,Object(r["createVNode"])(s,{action:"",ref:"orderForm"},{default:Object(r["withCtx"])((function(e){var a=e.errors;return[Object(r["createVNode"])("div",g,[Object(r["createVNode"])("table",f,[Object(r["createVNode"])("tbody",null,[Object(r["createVNode"])("tr",null,[y,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(new Date(1e3*o.order.create_at).toLocaleString()),1)]),Object(r["createVNode"])("tr",null,[D,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.order.id),1)]),Object(r["createVNode"])("tr",null,[v,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.order.user.name),1)]),Object(r["createVNode"])("tr",null,[k,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.order.user.email),1)]),Object(r["createVNode"])("tr",null,[w,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.order.user.tel),1)]),Object(r["createVNode"])("tr",null,[S,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.order.user.address),1)]),Object(r["createVNode"])("tr",null,[M,Object(r["createVNode"])("td",null,[(Object(r["openBlock"])(!0),Object(r["createBlock"])(r["Fragment"],null,Object(r["renderList"])(o.order.products,(function(e){return Object(r["openBlock"])(),Object(r["createBlock"])("p",{class:"d-flex mb-0",key:e.product.id},[Object(r["createTextVNode"])(Object(r["toDisplayString"])(e.product.title)+" x "+Object(r["toDisplayString"])(e.qty)+" "+Object(r["toDisplayString"])(e.product.unit)+"= ",1),Object(r["createVNode"])("span",x,"$"+Object(r["toDisplayString"])(Math.floor(e.final_total)),1)])})),128)),Object(r["createVNode"])("p",C," 合計 : $"+Object(r["toDisplayString"])(Math.floor(o.order.total)),1)])]),Object(r["createVNode"])("tr",null,[B,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.percent)+"折",1)]),Object(r["createVNode"])("tr",null,[P,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.order.message),1)]),Object(r["createVNode"])("tr",null,[_,Object(r["createVNode"])("td",null,Object(r["toDisplayString"])(o.order.is_paid?"已付款":"未付款"),1)])])]),Object(r["createVNode"])("div",L,[T,Object(r["createVNode"])(n,{id:"editTotal",name:"修改金額",type:"number",class:["form-control",{"is-invalid":a["修改金額"]}],rules:"min_value:0",modelValue:o.order.total,"onUpdate:modelValue":t[1]||(t[1]=function(e){return o.order.total=e})},null,8,["class","modelValue"]),Object(r["createVNode"])(l,{name:"修改金額",class:"invalid-feedback"})])]),Object(r["createVNode"])("div",F,[$,Object(r["createVNode"])("button",{type:"button",class:"btn btn-primary",onClick:t[2]||(t[2]=function(){return d.editTotal&&d.editTotal.apply(d,arguments)})}," 修改 ")])]})),_:1},512)])])],512)}a("b64b");var E=a("7c2b"),J=a.n(E),q={data:function(){return{modal:{},order:{user:{}},percent:0}},emits:["editTotal"],props:["data"],methods:{editTotal:function(){this.$emit("editTotal",this.order),this.hideModal()},showModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()},getPercent:function(){var e=Object.keys(this.order.products)[0];this.percent=this.order.products[e].coupon?"".concat(this.order.products[e].coupon.percent," "):"未打"}},mounted:function(){this.modal=new J.a(this.$refs.orderModal)},watch:{data:function(e){this.order=e,this.getPercent()}}};q.render=I;var U=q,z=a("86c0"),A={data:function(){return{orders:[],tempOrder:{user:{}},currentPage:1,totalPages:0,searchData:""}},methods:{getOrders:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:this.currentPage,a="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/orders?page=").concat(t);this.isLoading.status=!0,this.axios.get(a).then((function(t){t.data.success?(e.orders=t.data.orders,e.totalPages=t.data.pagination.total_pages,e.currentPage=t.data.pagination.current_page,e.isLoading.status=!1):e.swal(t.data.message,"error")})).catch((function(){e.swal("無法取得資料喔～快去看什麼問題吧！","error")}))},getFilterData:function(e){this.searchData=e},putOrder:function(e,t){var a=this,r={data:Object(p["a"])({},e)},c="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/order/").concat(r.data.id);this.isLoading.itemID=e.id,"isPaid"===t&&(r.data.is_paid=!r.data.is_paid),this.axios.put(c,r).then((function(e){e.data.success?(a.swal(e.data.message),a.getOrders(),a.isLoading.itemID=""):a.swal(e.data.message,"error")})).catch((function(){a.swal("無法修改資料喔～快去看什麼問題吧！","error")}))},deleteOrder:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/order/").concat(this.tempOrder.id);this.isLoading.itemID=this.tempOrder.id,this.axios.delete(t).then((function(t){t.data.success?(e.$refs.deleteModal.hideModal(),e.getOrders(),e.swal(t.data.message),e.isLoading.itemID=""):e.swal(t.data.message,"error")})).catch((function(){e.swal("無法刪除資料喔～快去看什麼問題吧！","error")}))},openDeleteModal:function(e){this.tempOrder=Object(p["a"])({},e),this.$refs.deleteModal.showModal()},openEditModal:function(e){this.tempOrder=JSON.parse(JSON.stringify(e)),this.$refs.orderModal.showModal()}},components:{OrderModal:U,DelModal:z["a"]},computed:{filterData:function(){var e=this;return this.orders.filter((function(t){return t.user.name.match(e.searchData)}))}},created:function(){this.getOrders()}};A.render=j;t["default"]=A}}]);
//# sourceMappingURL=chunk-b241b2f8.1e069085.js.map