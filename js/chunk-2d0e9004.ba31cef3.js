(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0e9004"],{"8c58":function(e,t,o){"use strict";o.r(t);var a=o("7a23"),c={class:"sticky-top bg-white ps-2 py-3 mb-1"},n=Object(a["createVNode"])("h2",{class:"h3"},"優惠券列表",-1),s={class:"d-flex"},r={class:"input-group"},d=Object(a["createVNode"])("span",{class:"input-group-text"},"搜尋優惠券名稱",-1),i={class:"table"},l=Object(a["createVNode"])("thead",null,[Object(a["createVNode"])("tr",null,[Object(a["createVNode"])("th",{class:"text-center border-secondary"},"優惠券名稱"),Object(a["createVNode"])("th",{class:"border-secondary"},"優惠券代碼"),Object(a["createVNode"])("th",{class:"text-center border-secondary"},"折扣率"),Object(a["createVNode"])("th",{class:"border-secondary"},"期限"),Object(a["createVNode"])("th",{class:"border-secondary"},"是否啟用"),Object(a["createVNode"])("th",{class:"border-secondary"},"操作")])],-1),u={class:"text-center"},p={class:"text-center"},b={width:"200"},m={class:"form-check form-switch"},h={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},j={class:"btn-group"};function O(e,t,o,O,f,g){var V=this,N=Object(a["resolveComponent"])("Loading"),C=Object(a["resolveComponent"])("Page"),v=Object(a["resolveComponent"])("Search"),k=Object(a["resolveComponent"])("CouponModal"),y=Object(a["resolveComponent"])("DelModal");return Object(a["openBlock"])(),Object(a["createBlock"])("div",null,[Object(a["createVNode"])(N,{active:e.isLoading.status},null,8,["active"]),Object(a["createVNode"])("div",c,[n,Object(a["createVNode"])("div",s,[Object(a["createVNode"])("input",{type:"button",value:"新增",class:"btn btn-primary me-2",onClick:t[1]||(t[1]=function(e){return g.openCouponModal(V.coupon)})}),Object(a["createVNode"])(C,{pages:f.totalPages,currentPage:f.currentPage,onDisplayPage:g.getCoupons,class:"me-2"},null,8,["pages","currentPage","onDisplayPage"]),Object(a["createVNode"])("div",r,[d,Object(a["createVNode"])(v,{onFilterData:g.getFilterData},null,8,["onFilterData"])])])]),Object(a["createVNode"])("table",i,[l,Object(a["createVNode"])("tbody",null,[(Object(a["openBlock"])(!0),Object(a["createBlock"])(a["Fragment"],null,Object(a["renderList"])(g.filterData,(function(t){return Object(a["openBlock"])(),Object(a["createBlock"])("tr",{key:t.id,class:{"table-primary":t.is_enabled}},[Object(a["createVNode"])("td",u,Object(a["toDisplayString"])(t.title),1),Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(t.code),1),Object(a["createVNode"])("td",p,Object(a["toDisplayString"])(t.percent),1),Object(a["createVNode"])("td",null,Object(a["toDisplayString"])(new Date(t.due_date).toLocaleString()),1),Object(a["createVNode"])("td",b,[Object(a["createVNode"])("div",m,[Object(a["createVNode"])("input",{class:"form-check-input",type:"checkbox",id:t.id,checked:t.is_enabled,onChange:function(e){return g.putCoupon(t)}},null,40,["id","checked","onChange"]),Object(a["createVNode"])("label",{class:"form-check-label",for:t.id},[Object(a["createTextVNode"])(Object(a["toDisplayString"])(t.is_enabled?"已啟用":"未啟用")+" ",1),e.isLoading.itemID===t.id?(Object(a["openBlock"])(),Object(a["createBlock"])("span",h)):Object(a["createCommentVNode"])("",!0)],8,["for"])])]),Object(a["createVNode"])("td",null,[Object(a["createVNode"])("div",j,[Object(a["createVNode"])("button",{type:"button",class:["btn btn-outline-dark border-secondary",{disabled:t.is_enabled}],onClick:function(e){return g.openCouponModal(t)}}," 修改 ",10,["onClick"]),Object(a["createVNode"])("input",{type:"button",value:"刪除",class:["btn btn-outline-danger border-secondary",{disabled:t.is_enabled}],onClick:function(e){return g.openDeleteModal(t)}},null,10,["onClick"])])])],2)})),128))])]),Object(a["createVNode"])(k,{ref:"couponModal","coupon-data":f.tempCoupon,onUpdate:g.getCoupons},null,8,["coupon-data","onUpdate"]),Object(a["createVNode"])(y,{ref:"deleteModal",title:f.tempCoupon.code,tab:"優惠券",onDeleteData:g.deleteCoupon},null,8,["title","onDeleteData"])])}var f=o("5530"),g=(o("99af"),o("4de4"),o("ac1f"),o("466d"),o("b64b"),{class:"modal fade",ref:"couponModal","data-bs-backdrop":"static","data-bs-keyboard":"false",tabindex:"-1"}),V={class:"modal-dialog"},N={class:"modal-content"},C={class:"modal-header"},v={key:0,class:"modal-title h5 text-primary"},k={key:1,class:"modal-title h5"},y={class:"modal-body"},D={class:"row g-3"},w={class:"col-12"},x=Object(a["createVNode"])("label",{for:"couponName",class:"form-label"},[Object(a["createTextVNode"])("名稱 "),Object(a["createVNode"])("span",{class:"text-danger"},"*")],-1),M={class:"col"},B=Object(a["createVNode"])("label",{for:"couponPercent",class:"form-label"},[Object(a["createTextVNode"])("折扣率 "),Object(a["createVNode"])("span",{class:"text-danger"},"*")],-1),F={class:"col"},L=Object(a["createVNode"])("label",{for:"couponCode",class:"form-label"},[Object(a["createTextVNode"])("代碼 "),Object(a["createVNode"])("span",{class:"text-danger"},"*")],-1),_={class:"modal-footer"},P={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},S=Object(a["createTextVNode"])("新增 "),I={key:0,class:"spinner-border spinner-border-sm me-2",role:"status","aria-hidden":"true"},T=Object(a["createTextVNode"])("修改 ");function $(e,t,o,c,n,s){var r=Object(a["resolveComponent"])("Field"),d=Object(a["resolveComponent"])("error-message"),i=Object(a["resolveComponent"])("Form");return Object(a["openBlock"])(),Object(a["createBlock"])("div",g,[Object(a["createVNode"])("div",V,[Object(a["createVNode"])("div",N,[Object(a["createVNode"])("div",C,[n.tempCoupon.id?(Object(a["openBlock"])(),Object(a["createBlock"])("p",k,"修改優惠券")):(Object(a["openBlock"])(),Object(a["createBlock"])("p",v,"新增優惠券")),Object(a["createVNode"])("button",{type:"button",class:"btn-close","data-bs-dismiss":"modal","aria-label":"Close",onClick:t[1]||(t[1]=function(){return s.resetForm&&s.resetForm.apply(s,arguments)})})]),Object(a["createVNode"])(i,{action:"",ref:"couponForm",onSubmit:s.selectSubmit},{default:Object(a["withCtx"])((function(o){var c=o.errors;return[Object(a["createVNode"])("div",y,[Object(a["createVNode"])("div",D,[Object(a["createVNode"])("div",w,[x,Object(a["createVNode"])(r,{id:"couponName",name:"名稱",type:"text",class:["form-control",{"is-invalid":c["名稱"]}],rules:"required",modelValue:n.tempCoupon.title,"onUpdate:modelValue":t[2]||(t[2]=function(e){return n.tempCoupon.title=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(d,{name:"名稱",class:"invalid-feedback"})]),Object(a["createVNode"])("div",M,[B,Object(a["createVNode"])(r,{id:"couponPercent",name:"折扣率",type:"number",class:["form-control",{"is-invalid":c["折扣率"]}],placeholder:"80 為 8 折",rules:"min_value:0|max_value:99|required",modelValue:n.tempCoupon.percent,"onUpdate:modelValue":t[3]||(t[3]=function(e){return n.tempCoupon.percent=e}),modelModifiers:{number:!0}},null,8,["class","modelValue"]),Object(a["createVNode"])(d,{name:"折扣率",class:"invalid-feedback"})]),Object(a["createVNode"])("div",F,[L,Object(a["createVNode"])(r,{id:"couponCode",name:"代碼",type:"text",class:["form-control",{"is-invalid":c["代碼"]}],placeholder:"英數較佳 e.g. VS777",rules:"min:5|required",modelValue:n.tempCoupon.code,"onUpdate:modelValue":t[4]||(t[4]=function(e){return n.tempCoupon.code=e})},null,8,["class","modelValue"]),Object(a["createVNode"])(d,{name:"代碼",class:"invalid-feedback"})])])]),Object(a["createVNode"])("div",_,[Object(a["createVNode"])("button",{type:"button",class:"btn btn-secondary","data-bs-dismiss":"modal",onClick:t[5]||(t[5]=function(){return s.resetForm&&s.resetForm.apply(s,arguments)})}," Close "),Object(a["createVNode"])("button",{type:"submit",class:"btn btn-primary",disabled:0!==Object.keys(c).length},[void 0===n.tempCoupon.id?(Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],{key:0},["add"===e.isLoading.itemID?(Object(a["openBlock"])(),Object(a["createBlock"])("span",P)):Object(a["createCommentVNode"])("",!0),S],64)):(Object(a["openBlock"])(),Object(a["createBlock"])(a["Fragment"],{key:1},[e.isLoading.itemID?(Object(a["openBlock"])(),Object(a["createBlock"])("span",I)):Object(a["createCommentVNode"])("",!0),T],64))],8,["disabled"])])]})),_:1},8,["onSubmit"])])])],512)}var U=o("7c2b"),q=o.n(U),J={data:function(){return{modal:{},tempCoupon:{title:"",percent:0,code:""}}},emits:["update"],props:["couponData"],methods:{addCoupon:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/coupon"),o=new Date,a={data:Object(f["a"])({},this.tempCoupon)};o.setDate(o.getDate()+30),a.data.due_date=o.getTime(),a.data.is_enabled=0,this.isLoading.itemID="add",this.axios.post(t,a).then((function(t){t.data.success?(e.hideModal(),e.$emit("update"),e.swal(t.data.message),e.isLoading.itemID=""):e.swal(t.data.message,"error")})).catch((function(){e.swal("無法加入資料喔～快去看什麼問題吧！","error")}))},putCoupon:function(){var e=this,t={data:Object(f["a"])({},this.tempCoupon)},o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/coupon/").concat(this.tempCoupon.id);this.isLoading.itemID=this.tempCoupon.id,this.axios.put(o,t).then((function(t){t.data.success?(e.hideModal(),e.$emit("update"),e.swal(t.data.message),e.isLoading.itemID=""):e.swal(t.data.message,"error")})).catch((function(){e.swal("無法修改資料喔～快去看什麼問題吧！","error")}))},selectSubmit:function(){this.tempCoupon.id?this.putCoupon():this.addCoupon()},showModal:function(){this.modal.show()},hideModal:function(){this.modal.hide()},resetForm:function(){this.$refs.couponForm.resetForm()}},mounted:function(){this.modal=new q.a(this.$refs.couponModal)},watch:{couponData:function(e){this.tempCoupon=e}}};J.render=$;var z=J,A=o("86c0"),E={data:function(){return{coupons:[],coupon:{title:"",percent:0,code:""},tempCoupon:{},currentPage:1,totalPages:0,searchData:""}},methods:{getCoupons:function(){var e=this,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/coupons?page=").concat(t);this.isLoading.status=!0,this.axios.get(o).then((function(t){t.data.success?(e.coupons=t.data.coupons,e.totalPages=t.data.pagination.total_pages,e.currentPage=t.data.pagination.current_page,e.isLoading.status=!1):e.swal(t.data.message,"error")})).catch((function(){e.swal("無法取得優惠券資料喔～快去看什麼問題吧！","error")}))},putCoupon:function(e){var t=this,o="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/coupon/").concat(e.id),a={data:Object(f["a"])({},e)};this.isLoading.itemID=e.id,0===a.data.is_enabled?a.data.is_enabled=1:a.data.is_enabled=0,this.axios.put(o,a).then((function(e){e.data.success?(t.loading=!1,t.getCoupons(),t.swal(e.data.message),t.isLoading.itemID=""):t.swal(e.data.message,"error")})).catch((function(){t.swal("無法修改資料喔～快去看什麼問題吧！","error")}))},deleteCoupon:function(){var e=this,t="".concat("https://vue3-course-api.hexschool.io","/api/").concat("item666","/admin/coupon/").concat(this.tempCoupon.id);this.isLoading.itemID=this.tempCoupon.id,this.axios.delete(t).then((function(t){t.data.success?(e.$refs.deleteModal.hideModal(),e.getCoupons(),e.swal(t.data.message),e.isLoading.itemID=""):e.swal(t.data.message,"error")})).catch((function(){e.swal("無法刪除資料喔～快去看什麼問題吧！","error")}))},openCouponModal:function(e){this.tempCoupon=Object(f["a"])({},e),this.$refs.couponModal.showModal()},openDeleteModal:function(e){this.tempCoupon=Object(f["a"])({},e),this.$refs.deleteModal.showModal()},getFilterData:function(e){this.searchData=e}},created:function(){this.getCoupons()},components:{CouponModal:z,DelModal:A["a"]},computed:{filterData:function(){var e=this;return this.coupons.filter((function(t){return t.code.match(e.searchData)}))}}};E.render=O;t["default"]=E}}]);
//# sourceMappingURL=chunk-2d0e9004.ba31cef3.js.map